@model EnjoyOurTour.Models.ViewModel.Customer.UpdateCustomerProfileViewModel
@{
    ViewBag.Title = "Update Customer Profile";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<form id="UpdateCustomerProfileForm" name="UpdateCustomerProfileForm" method="post">
    <div class="row">
        <div class="col-md-12 col-lg-6 col-lg-offset-3" id="errormsg">

        </div>
        <div class="col-md-12 col-lg-6 col-lg-offset-3">
            <h1 class="page-header">Update Customer Profile (Customer Code - @Model.CustomerCode)</h1>
        </div>
        <div class="col-md-6 col-lg-3 col-lg-offset-3">
            <input hidden id="CustomerId" name="CustomerId" value="@Model.CustomerId" />
            <div class="form-group">
                <label for="CustomerName">Name AS Per NRIC</label>
                <input type="text" id="CustomerName" name="CustomerName" class="form-control" style="color:red" placeholder="Enter Name" value="@Model.CustomerName" />
                @Html.ValidationMessageFor(e => e)
            </div>
            <div class="form-group">
                <label for="PhoneNumber">Phone Number</label>
                <input type="text" id="PhoneNumber" name="PhoneNumber" class="form-control" style="color:red"  placeholder="Enter Phone Number" value="@Model.PhoneNumber" />
                @Html.ValidationMessageFor(e => e.PhoneNumber)
            </div>
            <div class="form-group">
                <label for="Address">Address</label>
                <input type="text" id="Address" name="Address" class="form-control"  style="color:red" placeholder="Enter Address" value="@Model.Address" />
                @Html.ValidationMessageFor(e => e.Address)
            </div>
            <div class="form-group">
                <label for="BankName">Bank Name</label>
                <input type="Text" id="BankName" name="BankName" class="form-control"  style="color:red" placeholder="Enter BankName" value="@Model.BankName" />
                @Html.ValidationMessageFor(e => e.BankName)
            </div>         
            <div class="form-group">
                <label for="AgentCode">Agent Code</label>
                <label id="AgentCode" name="AgentCode" class="form-control">@Model.AgentCode</label>
                @Html.ValidationMessageFor(e => e.AgentCode)
            </div>
            <div class="form-group">
                <label for="IntroducerCode">Introducer Code</label>
                <label id="IntroducerCode" name="IntroducerCode" class="form-control">@Model.IntroducerCode</label>
                @Html.ValidationMessageFor(e => e.IntroducerCode)
            </div>
            <div class="form-group">
                <label for="RenewDate">Renew Date</label>
                <label id="RenewDate" name="RenewDate" class="form-control">@Model.RenewDate</label>
                @Html.ValidationMessageFor(e => e.RenewDate)
            </div>
            <div class="form-group">
                <label for="AvailableAmount">Available Amount</label>
                <label id="AvailableAmount" name="AvailableAmount" class="form-control">@Model.AvailableAmount</label>
                @Html.ValidationMessageFor(e => e.AvailableAmount)
            </div>
            <div class="form-group">
                <label for="AvailablePoint">Available Point</label>
                <label id="AvailablePoint" name="AvailablePoint" class="form-control">@Model.AvailablePoint</label>
                @Html.ValidationMessageFor(e => e.AvailablePoint)
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="form-group">
                <label for="NRIC">NRIC</label>
                <input type="text" id="NRIC" name="NRIC" class="form-control" style="color:red" placeholder="Enter NRIC" value="@Model.NRIC" />
                @Html.ValidationMessageFor(e => e.NRIC)
            </div>
            <div class="form-group">
                <label for="EmailAddress">Email Address</label>
                <input type="text" id="EmailAddress" name="EmailAddress" style="color:red" class="form-control" placeholder="Enter Email Address" value="@Model.EmailAddress" />
                @Html.ValidationMessageFor(e => e.EmailAddress)
            </div>
            <div class="form-group">
                <label for="DateOfBirth">Date Of Birth</label>
                <input type="text" id="DateOfBirth" name="DateOfBirth" style="color:red" class="form-control" placeholder="Enter Date Of Birth" value="@Model.DateOfBirth" />
                @Html.ValidationMessageFor(e => e.DateOfBirth)
            </div>
            <div class="form-group">
                <label for="BankAccountNumber">Bank Account Number</label>
                <input type="Text" id="BankAccountNumber" name="BankAccountNumber"  style="color:red" class="form-control" placeholder="Enter Bank Account Number" value="@Model.BankAccountNumber" />
                @Html.ValidationMessageFor(e => e.BankAccountNumber)
            </div>
            <div class="form-group">
                <label for="AgentName">Agent Name</label>
                <label id="AgentName" name="AgentName" class="form-control">@Model.AgentName</label>
                @Html.ValidationMessageFor(e => e.AgentName)
            </div>
            <div class="form-group">
                <label for="IntroducerName">Introducer Name</label>
                <label id="IntroducerName" name="IntroducerName" class="form-control">@Model.IntroducerName</label>
                @Html.ValidationMessageFor(e => e.IntroducerName)
            </div>
            <div class="form-group">
                <label for="ExpiredDate">Renew ExpiredDate</label>
                <label id="ExpiredDate" name="ExpiredDate" class="form-control">@Model.ExpiredDate</label>
                @Html.ValidationMessageFor(e => e.ExpiredDate)
            </div>
            <div class="form-group">
                <label for="AvailableTVR">Available TVR</label>
                <label id="AvailableTVR" name="AvailableTVR" class="form-control">@Model.AvailableTVR</label>
                @Html.ValidationMessageFor(e => e.AvailableTVR)
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-lg-9">
            <button type="button" id="btnSubmit" class="btn btn-primary pull-right">Update Profile</button>
        </div>        
    </div>
    <br />
    <div class="row">
        <div class="col-md-12 col-lg-6 col-lg-offset-3">
            <button type="button" class="btn btn-block pull-right" onclick="history.go(-1);">Back</button>
        </div>
    </div>
</form>


<script>

    $(document).ready(function () {
        $('#btnSubmit').click(function (e) {
            e.preventDefault();
            $('.loading').css('display', 'block');
            var form = $('form')[0];
            var formData = new FormData();
            formData.append('CustomerName', $('#CustomerName').val());
            formData.append('PhoneNumber', $('#PhoneNumber').val());
            formData.append('Address', $('#Address').val());
            formData.append('BankName', $('#BankName').val());
            formData.append('NRIC', $('#NRIC').val());
            formData.append('EmailAddress', $('#EmailAddress').val());
            formData.append('DateOfBirth', $('#DateOfBirth').val());
            formData.append('BankAccountNumber', $('#BankAccountNumber').val());      
            formData.append('CustomerId', $('#CustomerId').val());      
                        
            $.ajax({
                url: "/Customer/UpdateCustomerProfile",
                contentType: false,
                processData: false,
                traditional: true,
                dataType: 'json',
                data: formData,
                type: "POST",
                success: function (data) {     
                    if (data.success == true) {
                        $('.loading').css('display', 'none');
                        swal({
                            title: "Done",
                            text: "Successfully Update.",
                            type: "success"
                        },
                        function () {                            
                        });
                    } else {
                        $("#errormsg").html("");
                        var errormsg = "";
                        for (var i = 0; i < data.errors.length; i++) {
                            errormsg = errormsg  + "<li>" + data.errors[i] + "</li>"
                        }
                        var wholediv = "<p><strong>An error occured whilst trying to save this issue.</strong></p> " + "<ul data-bind='foreach: saveErrors()'>" + errormsg + "</ul>";
                        $("#errormsg").append(wholediv);
                    }                  
                },
                error: function (data) {
                    $('.loading').css('display', 'none');
                    //swal("Oops", "We couldn't connect to the server!", "error")
                }                
            });
        });
    });
</script>